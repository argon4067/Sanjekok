{% extends "base.html" %}
{% load static %}

{% block title %}안전자료실{% endblock %}

{% block script1 %}
<link rel="stylesheet" href="{% static 'CSS/safe/safe.css' %}">
{% endblock %}

{% block contents %}
<section class="safe-section">
  <div class="container py-5">

    <!-- 제목 -->
    <div class="safe-header text-center mb-5">
      <p class="subtitle">산업안전 관련 자료를 한곳에</p>
      <h2 class="fw-bold" style="color:#23333d;">안전자료실</h2>
    </div>

    <!-- ============================== -->
    <!-- 검색 + 필터 영역 -->
    <!-- ============================== -->
    <form method="get" class="safe-filter mb-5">
      <div class="filter-group">
        <!-- 언어 필터 -->
        <select name="lang" class="form-select">
          <option value="">전체 언어</option>
          <option value="한국어" {% if lang == "한국어" %}selected{% endif %}>한국어</option>
          <option value="외국어" {% if lang == "외국어" %}selected{% endif %}>외국어</option>
        </select>

        <!-- 자료형태 필터 -->
        <select name="type" class="form-select">
          <option value="">전체 형태</option>
          <option value="OPS" {% if material_type == "OPS" %}selected{% endif %}>OPS</option>
          <option value="동영상" {% if material_type == "동영상" %}selected{% endif %}>동영상</option>
          <option value="책자" {% if material_type == "책자" %}selected{% endif %}>책자</option>
          <option value="PPT" {% if material_type == "PPT" %}selected{% endif %}>PPT</option>
          <option value="기타" {% if material_type == "기타" %}selected{% endif %}>기타</option>
        </select>

        <!-- 검색 -->
        <input type="text" name="q" placeholder="검색어 입력" value="{{ q }}" class="form-control">

        <button type="submit" class="btn btn-search">검색</button>
      </div>
    </form>

    <!-- ============================== -->
    <!-- 자료 카드 리스트 -->
    <!-- ============================== -->
    <div class="safe-grid">
      {% for s in list %}
      <div class="safe-card">
        <div class="safe-img">
          <img src="{{ s.s_image_url }}" alt="자료 이미지">
        </div>
        <div class="safe-body">
          <h3 class="safe-title">{{ s.s_title }}</h3>
          <p class="safe-meta">
            {{ s.s_type }} / {{ s.s_language }}<br>
            등록일: {{ s.s_created_at }}
          </p>

          <!-- 태그 -->
          <div class="safe-tags">
            {% for t in s.tags.all %}
            <a href="?tag={{ t.st_tag }}" class="tag">#{{ t.st_tag }}</a>
            {% endfor %}
          </div>
        </div>
      </div>
      {% empty %}
      <p class="text-center mt-5">등록된 자료가 없습니다.</p>
      {% endfor %}
    </div>

  </div>
</section>
{% endblock %}